<?xml version="1.0" encoding="utf-8"?>
<openerp>


    <data>

    <!-- Holidays Calendar -->

<!--	    <record model="ir.actions.act_window" id="hr_holidays.action_hr_holidays_leaves_by_month">
	        <field name="context">{'no_sick_list': True}</field>
	    </record>-->

	    <record model="ir.actions.act_window" id="hr_holidays.open_ask_holidays">
	        <field name="context">{'default_type': 'remove'}</field>
	        <field name="domain">[('type','=','remove'),('user_id','=',uid)]</field>
	    </record>

	    <record model="ir.actions.act_window" id="hr_holidays.request_approve_holidays">
	        <field name="context">{'default_type': 'remove'}</field>
	        <field name="domain">[('type','=','remove'),('user_id','!=',uid)]</field>
	    </record>

	    <menuitem name="Leave Requests to Approve" parent="hr_holidays.menu_open_ask_holidays" id="hr_holidays.menu_request_approve_holidays" action="hr_holidays.request_approve_holidays" groups="base.group_user,base.group_hr_user,employee_joining.group_coo_emp,base.group_hr_manager,hr_security.group_hr_director"/>

        <record id="view_holidays_calendar" model="ir.ui.view">
            <field name="name">Holidays Calendar</field>
            <field name="model">holiday.calendar.period</field>
            <field name="arch" type="xml">
                <calendar string="Holiday Calendar" color="name" date_start="date_start" date_stop="date_end">
                    <field name="name"/>
                </calendar>
            </field>
        </record>

        <record id="action_holiday_calendar" model="ir.actions.act_window">
            <field name="name">Holidays Calendar</field>
            <field name="res_model">holiday.calendar.period</field>
            <field name="view_mode">calendar,tree,form</field>
            <field name="view_id" ref="view_holidays_calendar"/>
            <field name="context">{"calendar_default_user_id": uid}</field>
	    </record>



    <!-- Holiday Form View -->
        <record id="holiday_extension_view_form" model="ir.ui.view">
            <field name="name">holiday.extension.view.from</field>
            <field name="model">hr.holidays</field>
            <field name="inherit_id" ref="hr_holidays.edit_holiday_new"/>
            <field name="arch" type="xml">
                <data>

					<field name="state" position="replace">
						<field name="state" widget="statusbar" statusbar_visible="draft,confirm,validate" statusbar_colors='{"confirm":"blue","validate1":"blue","refuse":"red"}'/>
					</field>

                    <xpath expr="//button[@string='Approve']" position="before">
                        <button string="Submit" name="submit" type="workflow" states="draft" class="oe_highlight"/>
                    </xpath>

                    <xpath expr="//button[@string='Approve']" position="replace">
                        <button string="Approve" name="validate" type="workflow" class="oe_highlight"
                        	attrs="{'invisible': ['|', ('approve_refuse_invisible','!=',True),('state','!=','confirm')]}"
                        	groups="base.group_user,base.group_hr_user,base.group_hr_manager" context="{'confirm':True}"/>
                    </xpath>

					<xpath expr="//button[@string='Reset to Draft']" position="replace">
                    	<button string="Reset to Draft" name="set_to_draft" states="refuse" type="object" groups="base.group_hr_manager"/>
                    </xpath>

                    <xpath expr="//button[@string='Refuse']" position="replace">
                    	<button string="Refuse" name="refuse" type="workflow"
                    		 attrs="{'invisible': ['|', ('approve_refuse_invisible','!=',True),('state','not in ',['confirm','validate'])]}"
                    		 groups="base.group_user,base.group_hr_user,base.group_hr_manager"/>

                    	<button string="Refuse" name="refuse" states="validate1" type="workflow"
                    		 groups="employee_joining.group_coo_emp"/>
                    	<button string="Refuse" name="refuse" states="validate2" type="workflow"
                    		 groups="base.group_hr_manager"/>
                    </xpath>

                    <xpath expr="//button[@string='Validate']" position="replace">
                        <button string="Validate" name="second_validate" states="validate2" type="workflow" groups="base.group_hr_manager" class="oe_highlight" context="{'validate':True}"/>
                        <button string="Validate" name="second_validate" states="validate1" type="workflow" groups="employee_joining.group_coo_emp" class="oe_highlight" context="{'validate':True}"/>
                    </xpath>

<!--                     <xpath expr="//button[@string='Validate']" position="replace">-->
<!--                        <button string="Validate" name="second_validate" states="validate1" type="workflow" groups="base.group_hr_manager" class="oe_highlight" context="{'validate':True}"/>-->
<!--                    </xpath>-->

                    <xpath expr="//field[@name='holiday_status_id']" position="attributes">
                        <attribute name="options">{"no_open": True}</attribute>
                    </xpath>
                    <xpath expr="//field[@name='date_from']" position="replace">
                        <field name="date_from" widget="date" nolabel="1" on_change="onchange_date_from(date_to, date_from)" required="1" class="oe_inline"/>
                    </xpath>
                    <xpath expr="//field[@name='name']" position="replace">
                        <field name="sequence"/>
                        <field name="name" attrs="{'readonly':[('state','!=','draft')]}"/>
                        <field name="approve_refuse_invisible" invisible="1"/>
                    </xpath>
                    <xpath expr="//field[@name='department_id']" position="replace">
                        <field name="department_id" attrs="{'readonly':['|', ('state','!=','draft'), ('holiday_type','=','category')]}" groups="base.group_hr_user"/>
                    </xpath>


                    <xpath expr="//field[@name='date_to']" position="replace">
                        <field name="date_to" widget="date" nolabel="1" on_change="onchange_date_to(date_to, date_from)" required="1" class="oe_inline"/>
                    </xpath>
                    <xpath expr="//field[@name='number_of_days_temp']" position="replace">
                        <field name="number_of_days_temp" class="oe_inline" widget="integer" readonly="1"/> days
                    </xpath>
                    <xpath expr="//field[@name='name']" position="after">
                        <field name="number_of_days_temp1" widget="integer" invisible="1"/>
                    </xpath>

                    <xpath expr="//field[@name='holiday_status_id']" position="replace">
                        <field name="holiday_status_id" context="{'employee_id':employee_id}" widget="selection"/>
                    </xpath>
                    <xpath expr="//group" position="after">
                    	<group colspan="4" string="Attachments">
                        <field name="attachment_ids" nolabel="1">
                            <tree>
                                <field name="name" string="Document Name"/>
                                <field name="datas" string="Attachment" filename="name"/>
                            </tree>
                        </field>
                        <field name="notes" nolabel="1" colspan="4" placeholder="Add a reason..." attrs="{'readonly':[('state','!=','draft')]}"/>
                        </group>
                    </xpath>
                </data>
            </field>
        </record>

        <!-- Holiday Form View -->
        <record id="holiday_extension_view_form1" model="ir.ui.view">
            <field name="name">holiday.extension.view.from1</field>
            <field name="model">hr.holidays</field>
            <field name="inherit_id" ref="hr_holidays.allocation_company_new"/>
            <field name="arch" type="xml">
                <data>
                	<xpath expr="//field[@name='name']" position="before">
                		<field name="sequence"/>
                	</xpath>
                    <xpath expr="//field[@name='holiday_status_id']" position="after">
                        <field name="allocation_from" widget="date" required="1"  class="oe_inline"/>
                        <field name="allocation_to" widget="date" required="1" class="oe_inline"/>
                    </xpath>

                    <xpath expr="//button[@string='Approve']" position="before">
                        <button string="Submit" name="submit" type="workflow" states="draft" class="oe_highlight"/>
                    </xpath>
                    <xpath expr="//button[@string='Approve']" position="replace">
                        <button string="Approve" name="validate" states="confirm" type="workflow" groups="base.group_hr_manager,employee_joining.group_coo_emp" class="oe_highlight"/>
                    </xpath>
                    <xpath expr="//button[@string='Refuse']" position="replace">
                        <button string="Refuse" name="refuse" states="confirm,validate" type="workflow" groups="base.group_hr_manager,employee_joining.group_coo_emp"/>
                    </xpath>
                    <xpath expr="//button[@name='reset']" position="replace">
                        <button string="Reset to Draft" name="set_to_draft" states="confirm,refuse" type="object" groups="base.group_hr_manager,employee_joining.group_coo_emp"/>
                    </xpath>

                    <xpath expr="//field[@name='holiday_status_id']" position="replace">
                        <field name="holiday_status_id" context="{'employee_id':employee_id}" widget="selection" attrs="{'readonly':[('state','!=','draft')]}"/>
                    </xpath>
                    <xpath expr="//field[@name='name']" position="replace">
                        <field name="name" required="1" attrs="{'readonly':[('state','!=','draft')]}"/>
                    </xpath>
<!--                    <xpath expr="//field[@name='holiday_type']" position="replace">
                        <field name="holiday_type" on_change="onchange_type(holiday_type)" attrs="{'readonly':[('state','!=','draft')]}"/>
                    </xpath>-->
                    <xpath expr="//field[@name='number_of_days_temp']" position="replace">
                        <field name="number_of_days_temp" class="oe_inline" widget="integer" attrs="{'readonly':[('state','!=','draft')]}"/> days
                    </xpath>
<!--                    <xpath expr="//field[@name='employee_id']" position="replace">
                        <field name="employee_id" attrs="{'readonly':[('state','!=','draft')], 'required':[('holiday_type','=','employee')], 'invisible':[('holiday_type','=','category')]}"/>
                    </xpath>-->
<!--                    <xpath expr="//field[@name='notes']" position="replace">
                        <field name="notes" nolabel="1" colspan="4" placeholder="Add a reason..." attrs="{'readonly':[('state','!=','draft')]}"/>
                    </xpath>-->
                </data>
            </field>
        </record>

        <record model="ir.actions.act_window.view" id="hr_holidays.action_open_ask_holidays_calendar">
            <field name="sequence" eval="4"/>
        </record>

        <record id="view_holiday_calendar_year_tree" model="ir.ui.view">
            <field name="name">holidays.calendar.year.tree</field>
            <field name="model">holiday.calendar.year</field>
            <field name="arch" type="xml">
                <tree string="Holidays Calendar Year">
                    <field name="name"/>
                </tree>
            </field>
        </record>

        <record id="view_holiday_calendar_tree" model="ir.ui.view">
            <field name="name">holidays.calendar.tree</field>
            <field name="model">hr.holidays.calendar</field>
            <field name="arch" type="xml">
                <tree string="Holidays Calendar">
                    <field name="name"/>
                    <field name="year_id"/>
                    <field name="company_id"/>
                </tree>
            </field>
        </record>

        <record id="view_holiday_calendar_form" model="ir.ui.view">
            <field name="name">holidays.calendar.form</field>
            <field name="model">hr.holidays.calendar</field>
            <field name="arch" type="xml">
                <form string="Holidays Calendar" version="7.0">
                    <sheet>
                            <group>
                                <field name="name"/>
                                <field name="year_id" widget="selection"/>
                                <field name="company_id"/>
                            </group>
                            <group string="Holidays Period">
                            <field name="period_ids" nolabel="1">
                                <tree editable="top">
                                    <field name="name"/>
                                    <field name="date_start"/>
                                    <field name="date_end"/>
                                </tree>
                            </field>
                            </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="view_holiday_calendar_year_form" model="ir.ui.view">
            <field name="name">holidays.calendar.year.form</field>
            <field name="model">holiday.calendar.year</field>
            <field name="arch" type="xml">
                <form string="Holidays Calendar Year" version="7.0">
                    <sheet>
                        <group>
                            <field name="name"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="holiday_calendar_year_action" model="ir.actions.act_window">
            <field name="name">Holidays Calendar Year</field>
            <field name="res_model">holiday.calendar.year</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_holiday_calendar_year_tree"/>
        </record>

        <record id="holiday_calendar_action" model="ir.actions.act_window">
            <field name="name">Holidays Calendar</field>
            <field name="res_model">hr.holidays.calendar</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="view_holiday_calendar_tree"/>
        </record>


    </data>

    <data noupdate="1">
        <menuitem name="Holiday Calendar"
        id="mail_my_leave" parent="mail.mail_my_stuff"
        sequence="11" action="action_holiday_calendar"/>

        <menuitem parent="hr_holidays.menu_open_ask_holidays"
        id="hr_holidays.menu_open_allocation_holidays"
        action="hr_holidays.open_allocation_holidays"
        groups="base.group_hr_manager,base.group_hr_user,employee_joining.group_coo_emp"/>

        <menuitem action="holiday_calendar_year_action" name="Holidays Calendar Year" id="holidays_calendar_year_menu" parent="hr.menu_hr_configuration" sequence="14"/>
        <menuitem action="holiday_calendar_action" name="Holidays Calendar" id="holidays_calendar_menu" parent="hr.menu_hr_configuration" sequence="13"/>

    </data>
</openerp>
